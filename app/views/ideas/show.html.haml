/owner actions
- if @idea.user == current_user
  - unless @idea.published_at?
    %div{:class => "alert alert-warning", :role => "alert"}
      Publish the idea to make it visible to others.
    /= link_to 'Transfer ownership', edit_idea_path(@idea), class: 'btn btn-warning disabled'
    /= link_to 'Change idea status', edit_idea_path(@idea), class: 'btn btn-warning disabled'
    /= link_to 'Add proof of realisation', edit_idea_path(@idea), class: 'btn btn-warning disabled'
/owner actions
%p
.row
  /likes
  .col-md-auto
    .text-center
      - if current_user
        - if current_user.voted_up_on? @idea
          = fa_icon "thumbs-up", class: 'btn btn-sm btn-success disabled', "data-placement" => "right", "data-toggle" => "tooltip", :title => "You've already upvoted"
        - unless current_user.voted_for? @idea
          = link_to "<i class='fa fa-thumbs-up'></i>".html_safe, like_idea_path(@idea), method: :put, class: 'btn btn-sm btn-outline-success rounded-circle'
        .row
        %span.badge.badge-secondary.btn-block{"data-placement" => "right", "data-toggle" => "tooltip", :title => "all upvotes - downvotes"}
          = @idea.total_score
        .row
        - unless current_user.voted_for? @idea
          = link_to "<i class='fa fa-thumbs-down'></i>".html_safe, dislike_idea_path(@idea), method: :put, class: 'btn btn-sm btn-outline-danger rounded-circle'
        - if current_user.voted_down_on? @idea
          = fa_icon "thumbs-down", class: 'btn btn-sm btn-danger disabled', "data-placement" => "right", "data-toggle" => "tooltip", :title => "You've already downvoted"
      - else
        = fa_icon "thumbs-up", class: 'btn btn-sm btn-outline-success rounded-circle'
        .row
        %span.badge.badge-secondary.btn-block
          = @idea.total_score
        .row
        = fa_icon "thumbs-down", class: 'btn btn-sm btn-outline-danger rounded-circle'
  /likes
  /card
  .col
    .card
      %h5.card-header.bg-light
        = @idea.name
        - if @idea.user == current_user
          .pull-right
            - unless @idea.published
              = link_to "Publish", publish_idea_path(@idea), method: :patch, class: 'badge badge-success'
            /- else
            /  = link_to "UnPublish", unpublish_idea_path(@idea), method: :patch, class: 'badge badge-success'
            - unless @idea.published_at?
              = link_to 'Edit', edit_idea_path(@idea), class: 'badge badge-warning'
            - unless @idea.associations? && @idea.published_at?
              = link_to 'Destroy', @idea, method: :delete, data: { confirm: 'Are you sure?' }, class: 'badge badge-danger'
      .card-body
        = simple_format(@idea.description)
        .form-inline
          - @idea.tags.each do |tag|
            %span.badge.badge-success
              = link_to tag.name, tag_path(tag), class: 'text-white'
      .container
        .row.bg-light
          .col-lg
            %span.badge.badge-light
              = fa_icon "exclamation-triangle"
              = pluralize(@idea.attachments.count, 'attachment')
            %span.badge.badge-light
              = fa_icon "users"
              = pluralize(@idea.cofounders.count, 'cofounder')
          .col-lg
            .text-right
              .font-weight-light.font-italic
                - if @idea.published_at?
                  published
                  = time_ago_in_words(@idea.published_at)
                  ago
                  %br
                created
                = time_ago_in_words(@idea.created_at)
                ago by
                - if @idea.user_id == current_user.id
                  %span.badge.badge-success
                    You
                - else
                  = link_to @idea.user.username, user_path(@idea.user)
    .form-inline
      = social_share_button_tag("What do you think about this startup idea? '#{@idea.name}'", :allow_sites => %w(twitter linkedin telegram), desc: @idea.description)
      = social_share_button_tag @idea.name, desc: @idea.description, :allow_sites => %w(facebook)
/card
/progress-bar
%p
.text-light.text-center
  = pluralize(@idea.total_score, 'vote')
- if @idea.votes_for.any?
  .progress{:style => "height: 13px"}
    .progress-bar.bg-success{:style => "width:#{@idea.positive_percent}%"}
      =  @idea.positive_score
    .progress-bar.bg-danger{:style => "width:#{@idea.negative_percent}%"}
      =  @idea.negative_score
- else
  .progress{:style => "height: 13px"}
    .progress-bar.bg-success{:style => "width:50%"}
      =  @idea.positive_score
    .progress-bar.bg-danger{:style => "width:50%"}
      =  @idea.negative_score
.row.text-light
  .col-lg
    Liked by:
    - @idea.votes_for.up.by_type(User).voters.each do |user|
      #{user.username},
  .col-lg
    Disliked by:
    - @idea.votes_for.down.by_type(User).voters.each do |user|
      = user.username
%p
/progress-bar
/bottom-actions
.row
  .col-lg
    .text-white
      = fa_icon "exclamation-triangle"
      Similar projects
    = render 'attachments/form'
    %p
    = render 'attachments/index'
  .col-lg
    .text-white
      = fa_icon "users"
      Cofounders
    - unless @current_user_is_a_cofounder
      = render 'cofounders/form'
    - else
      %span.badge.badge-secondary
        %h5 You've applied!
    %p
    = render 'cofounders/index'
/bottom-actions
%br